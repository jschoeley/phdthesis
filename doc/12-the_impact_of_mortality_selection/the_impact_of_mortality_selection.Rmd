---
title: |
  The impact of population heterogeneity
  on the age trajectory of neonatal mortality
author: | 
  Jonas Sch√∂ley^[Interdisciplinary Centre on Population Dynamics, University of Southern Denmark. Correspondence: <jschoeley@health.sdu.dk>. During the writing of this article the author was a guest at the Max-Planck Institute for Demographic Research and funded by a grant from AXA Insurance.]
output:
  bookdown::pdf_book:
     template: ../thesis_style.tex
     citation_package: natbib
     fig_caption: yes
     keep_tex: false
     toc: false
header-includes:
  \usepackage{float}
  \floatplacement{figure}{H}
bibliography: [../refs.bib]
abstract: |
  **Background** The risk of death declines rapidly over the first month of life. It has been theorized that the fast pace of the decline is explained by hidden population heterogeneity resulting in a mortality selection process whereby the frailest infants leave the population at the fastest rate. A competing explanation situates the rapid mortality decline on the individual level, pointing towards the risky transition of birth and the subsequent adaptation of the newborn to the unfamiliar surroundings.
  
  **Objective** To estimate heterogeneity in the level and shape of age-specific mortality within a cohort of newborns and to quantify the degree to which mortality selection explains the shape of the average neonatal mortality trajectory.
  
  **Methods** Given individual-level data on 20,322,147 births and 82,562 neonatal deaths from the 2008-2012 U.S. birth cohort, I calculate life-tables for 252 mutually exclusive strata each defined by a unique combination of observed birth characteristics. Using this information, I characterize the distribution of mortality risk and its evolution over the first 28 days of life and decompose changes in key characteristics of this distribution -- the mean, the variance, and the mean-mode ratio -- into a mortality selection and a direct component.
  
  **Results** The average age trajectory of neonatal mortality is highly influenced by a small group of frail newborns and does not reflect the rather flat age effect estimated for the healthy majority of the birth cohort. While the risk decline over the first day of life is substantially influenced by mortality selection, the overall age trajectory is better explained by the convergence of high-risk towards low-risk population strata.
---

```{r setup, include=FALSE}
library(tidyverse)
library(kableExtra)

knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  cache = FALSE,
  dpi = 300,
  out.width = '100%',
  fig.align='center'
)
```

# Introduction

Never again throughout the existence of a cohort will the hazard of death change as rapidly as it does during the first few weeks following birth. For the 2009--2012 U.S. birth cohort, the risk of death falls tenfold over the first day of life, and again by a factor of ten over the next four weeks. But how reflective is this population-level phenomenon of a single newborn's risk trajectory? Is the period of exceptional risk right after birth part of every human's experience, or have we been led astray by one more of "Heterogeneity's Ruses" [@Vaupel1985]? In this paper, I seek to quantify the impact of population heterogeneity on the age trajectory of neonatal mortality based on *observed* mortality differences in a cohort of U.S. born infants.

Populations in which members are heterogeneous concerning their risk of death are subjected to mortality selection, which may be defined as the changing composition of a cohort over age due to heterogeneous mortality. As mortality is nothing but the rate of leaving a population due to death, with time, the proportion of low-mortality strata will increase, whereas strata with high mortality will become less prevalent. In consequence, any observed change of a cohorts trait over age (such as income, health, risk of death) may either be the result of within-stratum trait changes or result from a change in the cohort's composition along those strata over age due to mortality selection.

A rich (bio)demographic literature exists for the special case of mortality selection driving the shape of the population level hazard of death over age thus explaining phenomena such as late-life mortality plateaus [e.g., @Beard1959; @Vaupel1979; @Vaupel1993; @Steinsaltz2006; @Missov2015; @Colchero2019], the adolescent "accident hump" [@Remund2015], declining mortality following surgery [@Hougaard1986] or the age pattern of early life mortality [@Vaupel1983; @Hsieh1985; @Trussell1985; @Avraam2014]. All of the aforementioned literature features frailty models as a means to formalize, understand, and estimate the impact of population heterogeneity on the age trajectory of mortality. In these models, an individual's risk of death depends on a random quantity coined *frailty* [@Vaupel1979] that, on account of being unobserved, may be thought of as hidden heterogeneity between members of a cohort. Frailty is most commonly expressed in a proportional hazards framework where the hazard of death at age $x$ of an individual with frailty $z$ is given by $h(x|z)=zh_0(x)$ and $h_0(x)$ is a *baseline hazard* shared by all members of the population. An expression for the population/marginal/unconditional hazard $\overline{h}(x)$ can be derived^[An excellent introduction to this technique can be found in @Wienke2011.] by assuming a distribution of survival times for the case where $z=1$ with corresponding hazard $h_0$ and a distribution for the frailties at age $x=0$. It is then possible to fit $\overline{h}(x)$ to observed survival times or a life table and -- given the parameters of the fit and an array of formal relationships [@Vaupel1983; @Vaupel2014] -- to determine how hidden heterogeneity acts in the population under investigation. Herein lies one central attraction of frailty models: they allow inference about population heterogeneity even if none has been observed. The quality of the inference then, of course, crucially depends on the adequacy of the assumptions going into the model.

A frailty explanation for the age trajectory of mortality following birth has been put forward multiple times in the literature but never seriously followed up upon. @Vaupel1983 modeled the hazard of infant death, assuming a constant baseline hazard and multiplicative Gamma distributed frailty with unity mean and a variance of 500. Such a model implies that the majority of infants at birth are at virtually no risk of death with a small minority of critical cases^[A Gamma distribution with unity mean and variance 500 has more than 98.8 percent of its probability mass below the mean and 0.24 percent at least 100 times above.]. @Trussell1985 demonstrated how sensitive the choice of baseline hazard is when modeling infant mortality via a frailty model, with the Gompertz leading to decreasing and the Weibull to increasing individual-level risk trajectories. @Hougaard1984 hypothesized that the high mortality during the first year of life and the subsequent rapid decline might be the result of an "extreme frailty distribution" upon birth, meaning a distribution with a long right tail, and he proposed the inverse-Gamma distribution as a suitable candidate. @Hougaard1986 introduced a particularly flexible family of frailty distributions, including the Gamma, the inverse-Gaussian, and distributions derived from the positive-stable. He fitted a corresponding frailty model to data on time until death after myocardial infarct, a survival scenario not unlike the neonatal case as there is a stressor at time zero with mortality declining quickly and monotonically thereafter.

Indeed the Hougaard frailty model with a Gompertz baseline hazard (see Appendix \@ref(apdx-hg) for the model specification) gives an excellent fit not only to neonatal mortality but to the entire day-to-day infant life table of the 2009--2012 U.S. birth cohort, capturing the extremely steep decrease in hazard following birth and the subsequent log-linear decline during the post-neonatal period (Figure \@ref(fig:hougaard-gompertz-fit)). While by no means a proof of the frailty hypothesis, this simple model shows that a mortality selection explanation is consistent with the dynamics of daily mortality rates observed on the population level.

```{r hougaard-gompertz-fit, fig.cap='Predicted hazard (black) vs. life table mortality rates (gray) for the 2008--2012 U.S. birth cohort. Daily mortality rates over the first 365 days of life are well described by a Gompertz baseline distribution with Hougaard distributed frailties. Via the process of mortality selection, a mixture of log-linear individual level hazards, here drawn for various levels of frailty $z$, gives rise to a population level hazard with extreme curvature on the log scale. The area of the circles is in rough proportion to the number of deaths each day.'}
knitr::include_graphics('fig/hougaard_gompertz_fit.pdf')
```

More recently, the heterogeneous frailty hypothesis was discussed by @Levitis2011 and @Levitis2013 as an alternative to evolutionary explanations for "ontogenescence," i.e., the declining hazard of death following birth observed in many species. Via simulation Levitis demonstrated how age-independent individual-level risk leads to age-dependent population mortality rates. In a further variation on the theme, @Avraam2014 captured the decline in mortality from birth to adolescence by employing a discrete frailty model with subgroups featuring either exponentially increasing or constant hazards.

Without data on heterogeneous risks, the hypothesis of mortality selection can only be tested indirectly. While frailty models do provide heterogeneity estimates from population-level data alone, this can only be taken as suggestive evidence for a selection explanation. The estimated amount of heterogeneity depends crucially on the choice of baseline hazard, the choice of frailty distribution, the assumption of fixed versus changing frailty, and the specific way that frailty modulates the baseline hazards (proportional hazards vs. accelerated failure time). These assumptions can not be validated on population-level data as different model specifications yield the same parametric form for the marginal hazard [@Trussell1985; @Hoem1990; @Yashin2000]. I argue that a more convincing case for the impact of population heterogeneity on the age trajectory of mortality can be made by analyzing the distribution of risk in a cohort stratified by *observed* characteristics. For infants, such data is available on birth certificates.

A birth certificate contains a wealth of information that identifies potentially frail newborns. Routinely collected are birth weight, the length of pregnancy, and the Apgar score, an index of the vitality of the child shortly after delivery. The combination of these characteristics delineates hundreds of highly specific subpopulations within a single birth cohort and, based on the distribution of deaths and exposure times across these strata, I analyze the impact of population heterogeneity on the age trajectory of neonatal mortality using both discrete-time life table decomposition methodology and continuous-time hazard modeling in connection with results from formal demography. This approach of describing mortality selection along observed mortality differentials has little precedence as far as human mortality is concerned, an exception being @Remund2015 who, based on an analysis of French individual level survival data with covariates, found that selection effects contribute to the "accident hump" observed in the hazard trajectory of young adults.

Following the description of the U.S. 2008--2012 birth cohort, I outline a discrete life table approach and a complementary continuous time hazard method to quantify population heterogeneity and mortality selection and its impact on the age trajectory of neonatal mortality. This is followed by results on the distribution of neonatal mortality risks as it changes over age, the heterogeneity of hazard trajectories, and various decompositions of population-level statistics along the age dimension. A discussion of the results concludes the paper.

# Data

As population heterogeneity drives mortality selection, one can learn about selection effects by estimating the hazard of death across a diverse collection of population strata. Such estimation is possible given the publicly available "NCHS Cohort Linked Birth -- Infant Death Data Files" [@NCHS2016] which contain a complete census of births and infant deaths on the territory of the United States (excluding overseas territories) and feature most fields present on the birth and death certificates. The size and detail of the data allow the calculation of neonatal life tables over hundreds of subpopulations, capturing observed heterogeneity in mortality following birth.

To increase the sample size and thus the reliability of the stratum specific mortality estimates, I pool births and deaths across cohorts 2008 to 2012. This leaves a sample size of 20,322,147 births contributing 567,031,738 person-days of exposure to risk over the first 28 days of life, during which 82,562 neonatal deaths were registered.

Following the practice of statistical offices, I compute mortality rates based on *all* registered births and deaths, including cases with missing data on key birth characteristics and unreasonable covariate combinations (e.g., extremely preterm delivery with average birth weight). While this approach challenges any causal interpretation of the determinants of neonatal death, it allows one to capture, in great detail, the observed heterogeneity giving rise to the usual population-level estimates. For this paper, it is of no concern whether the relationship between observed characteristics at birth and risk of death is causal or not as the phenomenon of interest -- mortality selection -- is induced by any mortality differential between population strata, no matter the cause.

For stratification, I use the information on birth weight, age of gestation at delivery, and 5 minute Apgar score. These variables are routinely recorded upon birth and highly predictive of neonatal death [@Pollack2000; @Casey2001; @Park2018]. As the inclusion of further strata only contributes minimal additional heterogeneity compared to what is already captured by the  Apgar-birth weight-prematurity trias but considerably increases the computational demands of the model fitting procedure, I opted against it.

The variables are defined and discretized as follows:

Gestation at delivery alias prematurity
  : The number of weeks from conception to delivery commonly estimated by the time since the first day of the mother's last menstrual cycle plus 14 days. Discretized into five groups *Extremely preterm* (earlier than 28 weeks), *Very preterm* (28 to 32 weeks), *Moderate to late preterm* (32 to 37 weeks), *Term or post-term* (37 weeks or later), and  *Missing*.

Birth weight
  : The weight of the newborn child measured in the minutes following birth discretized into the five categories *Extremely low* (<1000g), *Very low* (1000--1500g), *Low* (1500--2500g), *Regular or high* (2500g and above) and *Missing*.

5 minute Apgar score
  : A measure of the infant's physical condition five minutes following birth, based on muscle activity, pulse, response to stimulation, skin color, and respiration of the newborn [@Apgar1953]. Vitality increases over integers zero to ten, with missings being treated explicitly as a twelfth category.

Table \@ref(tab:tab-summary) shows births, death counts, and empirical 28-day survival for the complete 2008 to 2012 birth cohort by level of gestation, birth weight, and Apgar score, respectively.

```{r tab-summary}
load('tab/tab_summary.Rdata')

tab_summary %>%
  replace_na(replace = list(level = '')) %>%
  select(
    variable, level,
    births, prp_births,
    deaths, prp_deaths,
    prb_surv
  ) %>%
  mutate_at(
    vars(births, deaths),
    ~ formatC(., format = 'd', big.mark = ',')
  ) %>%
  mutate_at(
    vars(prb_surv),
    ~ formatC(floor(.*1000)/10, format = 'f', digits = 1)
  ) %>%
  mutate_at(
    vars(prp_births, prp_deaths),
    ~ formatC(ceiling(.*1000)/10, format = 'f', digits = 1) %>%
      paste0('(',.,')')
  ) %>%
  select(-1) %>%
  kable(
    format =
     'latex',
    caption =
      'Summary statistics of the U.S. 2008--2012 birth cohort.',
    booktabs =
      TRUE,
    escape =
      FALSE,
    col.names =
      c('',
        'Births',
        '(\\%)',
        'Deaths',
        '(\\%)',
        '\\% 28 day survival'
      ),
    align = c('r'),
    linesep = ''
  ) %>%
  kable_styling(
    latex_options = c('basic', 'hold_position')
  ) %>%
  group_rows(
    'Total', start_row = 1, end_row = 2,
    colnum = 6
  ) %>%
  group_rows(
    '5 minute Apgar score', start_row = 2, end_row = 13,
    colnum = 6
  ) %>%
  group_rows(
    'Gestation at delivery', start_row = 14, end_row = 18,
    colnum = 6
  ) %>%
  group_rows(
    'Birth weight', start_row = 19, end_row = 23,
    colnum = 6
  )
```

# Methods

From neonatal life tables stratified by birth characteristics, I derive the empirical distribution of mortality rates conditioned on time since birth for a cohort of newborns. Age differences in three key characteristics of this distribution -- the mean, the variance, and the mean to mode ratio -- are then decomposed into components due to mortality selection and due to "direct" effects. Adopting a continuous-time perspective, I estimate hazard trajectories and survival curves for every subpopulation and a corresponding population hazard. By employing the Vaupel-Zhang equality, I calculate the degree to which the between-stratum variance in hazard rates compounds the slope of the population hazard at selected exact ages.

## Stratified infant life-tables

Consider a cohort of $i=1,\ldots,N$ newborns stratified into subpopulations $k=1,\ldots,K$ according to the combined discrete characteristics birth weight, age of gestation at birth and five minute Apgar score. Observed for every newborn are a survival time $t_{ik}$ in days since birth censored at day 28 and a binary death indicator $\delta_{ik}$. I partition the survival time into $j=1,\ldots,J$ non-overlapping daily age intervals $[x_j, x_j+1)$, where $x_j$ is the start of the $j$th age interval, and for each interval calculate stratum specific death counts ${D_{jk}=\sum_{i}\delta_{ijk}}$, population alive at the beginning of the age interval

$$
N_{jk}=\begin{cases}\text{Births}_k & \text{for}\,j=1\\ \text{Births}_k-\sum^{s=j}_{s=1}D_{j=s,k} & \text{for}\,j>1\end{cases},
$$

and person-days of exposure $E_{jk}=N_{j+1,k}+a_{jk}D_{jk}$, with $a_{jk}$ as the average time of death of those dying in age interval $j$. For the first day of life I calculate $a_j$ using information on the proportion of deaths during the first hour of life while for the other days the usual mid-point assumption $a_{jk}=0.5$ is employed. I then calculate stratum specific life table death rates $m_{jk}=\frac{D_{jk}}{E_{jk}}$ for each age interval and corresponding population level death rates $\overline{m}_j=\frac{\sum_k D_{jk}}{\sum_k E_{jk}}$ and relative exposures $p_{jk} = \frac{O_{jk}}{\sum_k E_{jk}}$. These tabulated counts, exposures, rates and proportions form the basis of all subsequent analyses.

## Discrete-time life table analysis

### Decomposing change in mean mortality over age

Using the shorthand $\Delta f_x=f_{x+1}-f_x$ let $\Delta \overline{m}_j$ denote the change in population-level mortality from age interval $j$ to $j+1$. How much of this difference is explained by a change of the subpopulation hazards and how much due to a change in the population composition induced by mortality selection? A straightforward solution to this decomposition problem can be derived by writing $\overline{m}_j = \sum_kp_{jk}m_{jk}$ and applying the product rule for finite differences [@Boole1880] to the equivalent products $m_{jk}p_{jk}=p_{jk}m_{jk}$ yielding the two expressions

$$
\begin{aligned}
  \Delta \overline{m}_j
  &= \sum_k p_{jk}\Delta m_{jk} + \sum_k m_{j+1,k} \Delta p_{jk} \\
  &= \sum_k m_{jk}\Delta p_{jk} + \sum_k p_{j+1,k} \Delta m_{jk},
\end{aligned}
$$

which when averaged give the well known Kitagawa decomposition [@Kitagawa1955],

\begin{equation}
  \Delta \overline{m}_j =
    \underbrace{
      \sum_k \frac{p_{jk}+p_{j+1,k}}{2}\Delta m_{jk}
    }_{
      \text{Direct change}~\Delta \overline{m}_j^D
    } +
    \underbrace{
      \sum_k \frac{m_{jk}+m_{j+1,k}}{2}\Delta p_{jk}
    }_{
      \text{Compositional change}~\Delta \overline{m}_j^C
    }.
(\#eq:decomp-rate)
\end{equation}

The two terms represent the change in the population mortality rate due to changes in the group-specific mortality rates and due to changing group composition. Of particular interest is the ratio $\frac{\Delta \overline{m}_j^C}{\Delta \overline{m}_j}$, which for $\Delta\overline{m}_j^C<0$ and $\Delta \overline{m}_j<0$ is the share of the decline in population mortality explained by a compositional shift of the population. If mortality selection is indeed the main driver of the age decline in mortality over the neonatal period, then the aforementioned ratio has to be greater than 0.5.

### Decomposing change in mortality rate variance over age

In addition to compounding the effect of age on the average risk of death, mortality selection can lower the variance of mortality rates across population strata as the survivors concentrate in more resilient subgroups. Alternatively, any change in population variance may result from stratum specific mortality rates converging over age. Because the variance of mortality rates across strata $k$ among the survivors in age group $j$ is the weighted average $v_j(x)=\sum_k p_{jk}s_{jk}$, with $s_{jk}=(m_{jk}-\overline{m}_{j})^2$, one can follow the same strategy as before to yield the Kitagawa-style decomposition

\begin{equation}
\Delta v_j =
  \underbrace{
    \sum_k \frac {p_{jk}+p_{j+1,k}} {2} \Delta s_{jk}
  }_{
    \text{Direct change}~\Delta v_j^D
  } +
  \underbrace{
    \sum_k \frac {s_{jk}+s_{j+1,k}} {2} \Delta p_{jk}
  }_{
    \text{Compositional change}~\Delta v_j^C
  },
(\#eq:decomp-var)
\end{equation}

with $v_j^D$ denoting the change in variance due to convergence or divergence of stratum specific mortality rates over age towards the population mean and $v_j^C$ the age-decline in variance due to changing population composition, i.e., mortality selection.

### Decomposing change in the ratio of mean to modal mortality over age

If the distribution of death rates in a cohort of infants exhibits positive skewness, mortality selection can reduce the mean-mode ratio of this distribution by "thinning the tail," i.e., by reducing the relative proportion of very frail subpopulations. However, any such decline may also result from genuine convergence of stratum specific death rates towards the death rates of the most prevalent stratum, the modal mortality rate, formally $\mathscr{M}_j = m_{j,k=r}$ with $r$ such that $p_{j,k=r}=\text{max}(p_{j1},\ldots,p_{jK})$.

A Kitagawa-style decomposition of the mean-mode ratio $\frac{\overline{m}_j}{\mathscr{M}_{j}} = \sum_k p_{jk}\frac{m_{jk}}{\mathscr{M}_j}$, shortened to $r_j$, gives the two components

\begin{equation}
\Delta r_j =
  \underbrace{
    \sum_k \frac {p_{jk}+p_{j+1,k}} {2}
    \Delta \frac{m_{jk}}{\mathscr{M}_j}
  }_{
    \text{Direct change}~\Delta r_j^D
  } +
  \underbrace{
    \sum_k \frac {
      \frac{m_{jk}}{\mathscr{M}_j} + \frac{m_{j+1,k}}{\mathscr{M}_{j+1}}
    } {2}
    \Delta p_{jk}
  }_{
    \text{Compositional change}~\Delta r_j^C
  },
(\#eq:decomp-memora)
\end{equation}

where $\Delta r_j^D$ captures the changing ratios of stratum specific mortality rates to modal mortality and $\Delta r_j^C$ referring to changes in the population composition.

## Continuous-time hazard analysis

In the following, I outline a methodology to decompose the age derivative of the population hazard of death into a "direct" component reflecting actual age-effect within the population strata, and a "compositional component" capturing the confounding effect of population heterogeneity.

### Estimating stratum specific hazard and survival

Stratum specific hazards during the neonatal period are well captured by the expression

\begin{equation}
  \begin{aligned}
    h_k(x) = e^{\beta_{0k} + \beta_{1k}\log(x+1) +
    \beta_{2k}\log^2(x+1)},
  \end{aligned}
(\#eq:lqhzrd)
\end{equation}

which can be interpreted as a Weibull hazard extended by a log-quadratic term over day of life (Appendix \@ref(apdx-quadratic-hzrd)). The curve has the advantage of being linear the log scale, thus allowing it to be fit as a generalized linear mixed/multilevel model, which greatly facilitates a stable estimation of stratum specific hazards. There are in total 252 strata in the population of newborns with each stratum $k$ marking a unique combination of "Prematurity," "Birth weight," and "Apgar score" levels. Fitting the hazard separately to each stratum will result in erratic estimates as some strata do not contain enough observations to inform the model. A solution to this problem is to fit a multilevel model where instead of estimating $\beta_{0k}, \beta_{1k}, \beta_{2k}$ directly one models the coefficient's distribution at different grouping levels.

Given the observed death counts $D_{jk}$ in age group $j$ and stratum $k$ and associated person-days of exposure to risk $O_{jk}$ I fit the model

\begin{equation}
  \begin{aligned}
    D_{jk} &\sim \text{Pois}\left(\lambda_{jk}O_{jk}\right) \\
    \lambda_{jk} &= e^{\beta_{0k} +
    \beta_{1k}\log(x_{jk}+1) +
    \beta_{2k}\log^2(x_{jk}+1)},
  \end{aligned}
(\#eq:themodel)
\end{equation}

where $\lambda_{jk}$ are mortality rates by age group and stratum. For each stratum, a smooth hazard is recovered by evaluating $\lambda_{jk}$ over a continuous range of ages $x$ as in equation \@ref(eq:lqhzrd).

The stratum specific coefficients $\beta_{0k}$, $\beta_{1k}$, $\beta_{2k}$ are sums of baseline coefficients $\beta$, prematurity effects $\beta^\text{Pm}$, prematurity-birth weight interactions $\beta^{\text{Pm}\times\text{Bw}}$, and prematurity-birth weight-Apgar interactions $\beta^{\text{Pm}\times\text{Bw}\times\text{Ap}}$ resulting in the multilevel structure

$$
\left(\begin{aligned}
\beta_{0k} \\
\beta_{1k} \\
\beta_{2k}
\end{aligned}\right) =
\underbrace{\left(\begin{aligned}
\beta_0 \\
\beta_1 \\
\beta_2
\end{aligned}\right)}_{\substack{\text{lvl 0} \\ \text{ baseline coef.}}} +
\underbrace{\left(\begin{aligned}
\beta_{0,p[k]}^\text{Pm} \\
\beta_{1,p[k]}^\text{Pm} \\
\beta_{2,p[k]}^\text{Pm}
\end{aligned}\right)}_{\substack{\text{lvl 1} \\ \text{ deviations by} \\ \text{prematurity}}} +
\underbrace{\left(\begin{aligned}
\beta_{0,p[k],b[k]}^{\text{Pm}\times\text{Bw}} \\
\beta_{1,p[k],b[k]}^{\text{Pm}\times\text{Bw}} \\
\beta_{2,p[k],b[k]}^{\text{Pm}\times\text{Bw}}
\end{aligned}\right)}_{\substack{\text{lvl 2} \\ \text{ deviations by} \\ \text{birth weight given} \\ \text{prematurity}}} +
\underbrace{\left(\begin{aligned}
\beta_{0,p[k],b[k],a[k]}^{\text{Pm}\times\text{Bw}\times\text{Ap}} \\
\beta_{1,p[k],b[k],a[k]}^{\text{Pm}\times\text{Bw}\times\text{Ap}} \\
\beta_{2,p[k],b[k],a[k]}^{\text{Pm}\times\text{Bw}\times\text{Ap}}
\end{aligned}\right)}_{\substack{\text{lvl 3} \\ \text{ deviations by} \\ \text{Apgar given} \\ \text{prematurity and} \\ \text{birth weight}}},
$$

where $p[k], b[k]$ and $a[k]$ denote the prematurity, birth weight and Apgar level associated with stratum $k$. Except for the baseline $\beta$'s each set of coefficients is assumed to be drawn from a multivariate-Normal distribution with zero mean and covariance matrix

$$
\Sigma = \begin{pmatrix}
    \sigma^2_{\beta_0} & \sigma_{\beta_0\beta_1} & \sigma_{\beta_0\beta_2} \\
    \sigma_{\beta_0\beta_1} & \sigma^2_{\beta_1} & \sigma_{\beta_1\beta_2} \\
    \sigma_{\beta_0\beta_2} & \sigma_{\beta_1\beta_2} & \sigma^2_{\beta_2}
    \end{pmatrix},
$$

with separate estimates for levels one to three.

Treating the coefficients as realizations from a multivariate-Normal distribution with zero mean acts as a regularizer on the estimated hazard trajectories. In cases where zero or very few deaths are observed, the stratum specific deviations will be "pulled" towards zero with the effect that the estimated hazard resembles the hazard of the next higher hierarchy level [@Gelman2007]. Take as an example the 303 infants delivered "Very preterm" with "Very low" birth weight and given an Apgar score of 10. Because all newborns survived the neonatal period, there is no information available to learn the shape of the underlying hazard. In the multilevel model, the larger population of infants delivered "Very preterm" with "Very low" birth weight will inform the hazard of the Apgar 10 subgroup. If plenty of data is available, then the hazard estimate will follow that data closely.

I fit model \@ref(eq:themodel) as a Generalized Linear Mixed Model using the `lme4` library in `R` [@Bates2015] and use the fitted coefficients to compute stratum specific hazard trajectories and survival curves -- the basis for the Vaupel-Zhang decomposition -- using the expressions given in Appendix \@ref(apdx-vz).

### Vaupel-Zhang decomposition

The Vaupel-Zhang equality [@Vaupel2010a] states that in any cohort stratified by some random characteristic $K$ with initial distribution $\pi_k = P(K=k)$ the age derivative of the average hazard of death amongst the survivors at age $x$ can be written as

$$
  \dot{\overline{h}}(x) = \overline{\dot{h}}(x) - \sigma^2_h(x),
$$

where $\overline{\dot{h}}(x)$ denotes average slope and $\sigma^2_h(x)$ the average variance of hazards for the survivors at $x$. This result can be interpreted as a decomposition of the slope in the population hazard at $x$ into a direct and a compositional component: The first component is based upon the actual slopes of hazards within each stratum $k$. Only if the population is completely homogeneous with respect to the levels of their hazards is the slope in the population hazard equal to the average slope in the stratum specific hazards. When, however, the variance of hazards is not zero, i.e., the population differs in their risk of death, mortality selection biases the slope in the population level hazard downwards. In other words, the trajectory of the population hazard over age is explained by the average hazard trajectory across population strata compounded by heterogeneity in the level of hazard.

The quantity of interest is the ratio $\nu(x)=\frac{-\sigma_h^2(x)}{\dot{\overline{h}}(x)}$ which, given that $\dot{\overline{h}}(x)<0$, is the share of decline in the population hazard at $x$ explained by population heterogeneity in the level of mortality. From the observed distribution of birth characteristics $\pi_k=\frac{\text{Births}_k}{\Sigma_k\text{Births}_k}$ and the estimated stratum specific hazards $h_k(x)$ and survival $S_k(x)$ I calculate the population survival curve $S(x) = \sum_k \pi_k S_k(x)$ and the stratum distribution conditioned on survival to a given age $\pi_k(x) = \frac{S_k(x)\pi_k}{S(x)}$ which in turn gives rise to the population hazard curve $\overline{h}(x)= \sum_k \pi_k(x)h_k(x)$, and the variance of hazards over population strata $\sigma^2_h(x) = \sum_k \pi_k(x) (h_k(x)-\overline{h}(x))^2$. See Appendix \@ref(apdx-vz) for a derivation of the stated equalities.

# Results

## Extreme skewness and Taylor's law in the distribution of mortality

The distribution of mortality rates over population strata conditioned on neonatal age is characterized by the high proportion of lowest-low mortality infants, an extremely long right tail of high-risk subpopulations, and a power-law relationship between expectation and variance (Taylor's law). With more than 72 percent share on the total population, the group of infants who are born on term or post-term with regular or high birth weight and a five minute Apgar score of nine, are the most prevalent stratum throughout the entire neonatal period. Their mortality (the mode of the distribution of mortality risk) is among the lowest observed and remains relatively constant throughout the first four weeks of life. The quantile of average mortality well demonstrates the extremely long right tail of the mortality risk distribution: On the day of birth, 98 percent of newborns are part of a stratum with a risk of death lower than the population average. Over the next four weeks, the skewness decreases, but the expected value remains a bad measure of centrality (Figure \@ref(fig:distribution-of-risk)B). On a log-log plot, the relationship between mean and variance of the distribution of mortality risk over the first 28 days of life is almost perfectly linear with a slope of 2.5. The fitted regression model reproduces this linearity (Figure \@ref(fig:distribution-of-risk)A).

```{r distribution-of-risk, fig.cap='Mean-variance relationship over day of age (A) and age-specific distribution function (B) of the mortality/hazard rates in a cohort of newborns across birth weight, gestational age, and Apgar score strata. The points in (A) mark mean and variance of the life table mortality rates, whereas the smooth line is the prediction from the Poisson regression. In plot (B), the gray lines refer to the life table estimates and the black lines to the model predictions.'}
knitr::include_graphics('fig/distribution_of_risk.pdf')
```

## Shape and level of hazards are heterogeneous

The hazard trajectories predicted by the multilevel Poisson regression model \@ref(eq:themodel) closely match the mortality rate estimates from the life table. They reflect a high degree of heterogeneity among the 252 birth weight$\times$prematurity$\times$Apgar score strata of the U.S. 2009--2012 birth cohort (Figure \@ref(fig:neonatal-hazard-trajectories)), varying both in level and shape. The heterogeneity is well illustrated by contrasting the lowest-low mortality subgroup (term-born infants with regular birth weight and an Apgar score of ten) with the highest-high mortality stratum (extremely premature infants with extremely low birth weight and an Apgar score of zero). At birth, the force of mortality ranges across five orders of magnitude with a hazard ratio roughly 244-thousand (!) between the extremes but over time hazards converge as there is a strong positive correlation between the level of the hazard at birth and the rate of mortality decline over the neonatal period. While the lowest-low mortality group features a comparatively flat hazard over age, declining by 39 percent over days 0 to 28, the hazard of the highest-high risk stratum drops by 99.8 percent over the same period. Hazard trajectories by Apgar score are stratified as expected on a low-high mortality continuum from ten to zero stretching multiple orders of magnitude within all birth weight $\times$ prematurity combinations. However, hazards by Apgar score are clustered more closely among extremely preterm infants with extremely low birth-weight compared to term-born infants of regular or high birth weight.

While the hazards are heterogeneous when compared directly, the majority of newborns are born on full-term, with regular birth weight and an Apgar score of nine. Thus the majority of the birth cohort is homogeneous with respect to their hazard trajectory.

```{r neonatal-hazard-trajectories, fig.cap='Estimated hazard rates versus life table mortality rates over age by prematurity, birth weight, and Apgar score. There is substantial heterogeneity in the level and the shape of the neonatal hazard trajectories ruling out the hypothesis of proportional frailties. The black line in each panel shows the estimated hazard trajectory for the entire birth cohort.'}
knitr::include_graphics('fig/neonatal_hazard_trajectories.pdf')
```

## Mortality selection mainly acts shortly after birth

Population-level mortality during the first day of life is ten times higher than mortality over the following day. This 90 percent mortality decline over 24 hours is mostly the result of a corresponding drop in the stratum specific mortality rates, which, on average, declined by 71 percent between both time points. The remaining 19 percent decline is explained by a change in population composition due to mortality selection on the day of birth. Over the following time intervals, mortality continues to decline at a fast pace with compositional effects ceasing to contribute substantially to this decline. At no point is the ratio of compositional mortality decline to total mortality decline $\frac{\Delta \overline{m}_j^C}{\Delta \overline{m}_j}$ higher, or even near 0.5 (Table \@ref(tab:tab-decomp-raw-rates)).

The results from the discrete-time life table analysis are mirrored by the Vaupel-Zhang decomposition of the hazard's rate of change at different ages. The contribution of mortality rate variance across strata to the slope in the hazard is around 23 percent at birth but merely 4.6 percent 24 hours later staying in the single digits over the remainder of the first month of life (Table \@ref(tab:tab-vaupel-zhang)).

```{r counterfactual-hazards, fig.cap='Keeping the population composition fixed at the distribution observed at birth only results in a minor change of the population hazard trajectory.', out.width='50%'}
knitr::include_graphics('fig/counterfactual_hazards.pdf')
```

In order to understand the impact of mortality selection on the overall shape of the hazard trajectory I compare the estimated population average hazard over age with a counterfactual population hazard based on the stratum specific hazard estimates of model \@ref(eq:themodel) but assuming the stratum specific population proportions to be fixed, thereby negating the effect of mortality selection on the population hazard. Figure \@ref(fig:counterfactual-hazards) clearly shows that the steep decline in the risk of death following birth is not explained by selection due to differential mortality along the birth weight, Apgar score, and prematurity strata. However, mortality selection has some noticeable effect on the level of risk: Without selection, the hazard of death at day 28 would be an estimated 14 percent higher.

```{r tab-decomp-raw-rates}
load('tab/tab_rate_change.Rdata')

tab_rate_change %>%
  mutate_all(
    ~ str_replace(., 'e-0', 'e-')
  ) %>%
  kable(
    format =
      'latex',
    caption =
      'Direct and compositional components of mortality rate decline over the neonatal period.',
    booktabs =
      TRUE,
    escape =
      FALSE,
    col.names =
      c('Age',
        '$\\overline{m}_j$',
        '',
        '$\\Delta \\overline{m}_j$',
        '(\\%)',
        '$\\Delta \\overline{m}_j^D$',
        ' (\\%)',
        '$\\Delta \\overline{m}_j^C$',
        '(\\%)',
        '$\\frac{\\Delta \\overline{m}_j^C}{\\Delta \\overline{m}_j}\\%$'
      ),
    linesep = '',
    align = c('rrllllllll')
  ) %>%
  kable_styling(latex_options = 'basic') %>%
  add_footnote(
    label =
      c('Age refers to single day age groups.'),
    notation = 'none',
    escape = FALSE
  )
```

```{r tab-vaupel-zhang}
load('tab/tab_vaupel_zhang.Rdata')

tab_vaupel_zhang %>%
  mutate_all(
    ~ str_replace(., 'e-0', 'e-')
  ) %>%
  kable(
    format =
      'latex',
    caption =
      'Vaupel-Zhang decomposition of the slope in the hazard of death into direct and compositional components at selected ages.',
    booktabs =
      TRUE,
    escape =
      FALSE,
    col.names =
      c('Age $x$',
        '$h(x)$',
        '$\\dot{\\overline{h}}(x)$',
        '$\\overline{\\dot{h}}(x)$',
        '$\\sigma^2_h(x)$',
        '$\\nu(x)\\%$'),
    linesep = ''
  ) %>%
  kable_styling(latex_options = 'basic')
```

## Stratum specific mortality converges

Following birth, the stratum specific mortality rates rapidly converge, explaining both the sudden decline in variance and mean-mode ratio of the mortality rate distribution (Figures \@ref(fig:distribution-of-risk), \@ref(fig:mean-mode-convergence)).

```{r mean-mode-convergence, fig.cap='The ratio of the population average and the modal mortality rates over the first four weeks of life. Following birth population mortality converges towards the low mortality of the most prevalent stratum (Apgar 9, Regular or high birth weight, born term or post-term) which is due to the convergence of high-risk strata.'}
knitr::include_graphics('fig/mean_mode_convergence.pdf')
```

The variance of death rates over strata is highest at birth and falls by more than 90 percent from day 0 to day 1 of age. The decline in variance is mainly the result of stratum specific death rates converging towards the population average, with only 19 percentage points decline explained by mortality selection. The mortality variance continues to decline substantially over the remainder of the first month of life, with mortality selection never contributing more than 4.5 percent to the total decline (Table \@ref(tab:tab-decomp-raw-variances)).

During the first day of life, population mortality is 189 times higher than the mortality of the most prevalent stratum. This ratio declines by 85 percent over the next day of life, with only 20 percentage points of this decline explained by a shifting population composition. During the remainder of the neonatal period, mortality selection only minimally influences the continuing changes in the mean-mode mortality ratio, which eventually arrives at a value of around 3, a drop by 98 percent compared to the value at birth.

```{r tab-decomp-raw-variances}
load('tab/tab_var_change.Rdata')

tab_rate_change %>%
  mutate_all(
    ~ str_replace(., 'e-0', 'e-')
  ) %>%
  kable(
    format =
      'latex',
    caption =
      'Direct and compositional components of mortality rate variance decline over the neonatal period.',
    booktabs =
      TRUE,
    escape =
      FALSE,
    col.names =
      c('Age',
        '$v_j$',
        '',
        '$\\Delta v_j$',
        '(\\%)',
        '$\\Delta v_j^D$',
        ' (\\%)',
        '$\\Delta v_j^C$',
        '(\\%)',
        '$\\frac{\\Delta v_j^C}{\\Delta v_j^D}\\%$'
      ),
    linesep = '',
    align = c('rrllllllll')
  ) %>%
  kable_styling(latex_options = 'basic') %>%
  add_footnote(
    label =
      c('Age refers to single day age groups.'),
    notation = 'none',
    escape = FALSE
  )
```

```{r tab-memora-change}
load('tab/tab_memora_change.Rdata')

tab_memora_change %>%
  kable(
    format =
      'latex',
    caption =
      'Direct and compositional components of mean-mode ratio decline over the neonatal period.',
    booktabs =
      TRUE,
    escape =
      FALSE,
    col.names =
      c('Age',
        '$r_j$',
        '',
        '$\\Delta~r_{j}$',
        '(\\%)',
        '$\\Delta~r_{j}^D$',
        ' (\\%)',
        '$\\Delta~r_{j}^C$',
        '(\\%)',
        '$\\frac{\\Delta~r_{j}^C}{\\Delta~r_{j}^D}\\%$'
      ),
    linesep = '',
    align = c('rrllllllll')
  ) %>%
  kable_styling(latex_options = 'basic') %>%
  add_footnote(
    label =
      c('Age refers to single day age groups.'),
    notation = 'none',
    escape = FALSE
  )
```

# Discussion

Frailty theory cautions us against taking the population level hazard shape as representative for the risk trajectory of the population members. The analysis of neonatal mortality indeed clearly demonstrates the potential severity of this ecological fallacy, with the majority of newborns experiencing a hazard trajectory radically different from what is observed on the aggregate level. Yet, this difference does not arise from mortality selection but from the non-proportionality of stratum specific hazards. Neonatologists know that the first 24 hours of life are the most critical in determining the further survival of the preterm infant. Once the one-day threshold is passed, the survival chances not only drastically improve but, as shown in this paper, converge towards the survival chances of healthy term-born infants. The popular proportional frailty model is severely misspecified for situations where an individual may be saved due to medical intervention, i.e., where the physiological state of an individual and thus the associated frailty changes abruptly. In consequence, even if the model fits the aggregate age pattern well, as it does in case of the Hougaard-Gompertz fit to the age trajectory of infant mortality (Figure \@ref(fig:hougaard-gompertz-fit)), inferences drawn from it are biased.

To escape the strong assumptions of frailty models, I based the analysis in this paper on the *observed* heterogeneity in age-specific mortality across mutually exclusive population strata but, in turn, left open the possibility for *hidden* heterogeneity within a particular stratum. A further division of the population along the presence and severity of congenital malformations may uncover that the mortality decline following birth is primarily the effect of the vanishing subpopulation of newborns featuring congenital disabilities incompatible with life. While this particular hypothesis can be tested in a future publication, one can never exclude the possibility of further unobserved quantities influencing observed outcomes. All that can be confidently said based on the data analyzed above is that the heterogeneity in risk along birth weight, Apgar score, and prematurity has only a minimal impact on the shape of the population level age trajectory of neonatal mortality.

A peculiar finding is the near-perfect power-law relationship between the mean and the variance of the distribution of stratum-specific mortality rates over age -- a further example of "Taylor's law" in demography: Analyzing data on the spatial distribution of various species @Taylor1961 observed that the variance in population count per unit area is well predicted by a power of the average population count. Similar mean-variance relationships have been found for population densities in human populations [@Cohen2013; @Naccarato2018] and recently for time-series of age-specific mortality rates and rates of mortality improvement [@Bohk2015; @Cohen2018]. Whereas the studies by Cohen, Bohk, and Rau are based on the concept of a "temporal mean/variance," i.e., mean and variance are estimated from observations repeated over age or period, I contribute the first demonstration of Taylor's law in human mortality based on the distribution of risk at any single point in time within a cohort of individuals followed over age.

# Conclusion

The sudden drop in population mortality following birth is predominantly the result of stratum specific hazard rates quickly converging towards rather low levels. The compositional shift in the population resulting from mortality selection only has a minimal impact on the age trajectory of neonatal mortality.

It remains to be seen if the simple power-law expression that describes the time-evolution of mean and variance in mortality among a cohort of newborns replicates in other populations and at other ages. The prospect of having a 2-parameter expression for the mortality dynamics in a heterogeneous aging cohort may motivate future inquiries in that direction.

\clearpage

# (APPENDIX) Appendix {-}

# The Hougaard-Gompertz frailty model {#apdx-hg}

Let the hazard of death at age $x$ for a newborn with frailty $z$ be $h_z(x|z)=zh_0(x)$ with $z$ drawn from the three parameter frailty distribution proposed by @Hougaard1986 denoted with $Z \sim \text{Houg}(x; \alpha, \delta, \theta)$ and Gompertz baseline hazard $h_0(x)=ae^{bx}$ with corresponding cumulative hazard $H_0(x) = \int_0^x h_0(s)\,\text{d}s=a(e^{bx}-1)/b$. The average frailty among the survivors at $x$ then is $\text{E}[Z|X\geq x]=\delta\left(\theta + H_0(x)\right)^{\alpha -1}$ [@Hougaard1986, p. 393]. Substituting $\delta = \frac{1} {\theta^{\alpha-1}}$ eliminates one parameter from the model and fixes the average frailty at birth at one. The population hazard then is

$$
h(x)=\text{E}[Z|X=x]h_0(x)=\left(\frac{\theta + a(e^{bx}-1)/b}{\theta}\right)^{\alpha -1}ae^{bx},
$$

with log-hazard

$$
\log h(x) =
  (\alpha-1)\log\left(\frac{\theta + a(e^{bx}-1)/b}{\theta}\right) +
  \log a + bx
$$

The above hazard is fitted to daily death counts $D_j$ and exposure times $E_j$ of the U.S. 2009--2012 infant life table via a Bayesian non-linear Poisson regression model

$$
\begin{aligned}
  D_j &\sim \text{Pois}(\lambda_jE_j)~\text{for}~j=1,\ldots,365 \\
  \lambda_j &= e^{\log h(x_j;a,b,\theta,\alpha)}
\end{aligned}
$$

with parameter transformations

$$
\begin{aligned}
  a &= e^{\beta_0} \\
  b &= \beta_1 \\
  \theta &= e^{\beta_2} \\
  \alpha &= \log\frac{\beta_3}{1-\beta_3},
\end{aligned}
$$

and priors

$$
\begin{aligned}
  \beta_0 &\sim \text{N}(-8, 1) \\
  \beta_1 &\sim \text{N}(-0.03, 1) \\
  \beta_2 &\sim \text{N}(-6, 1) \\
  \beta_3 &\sim \text{N}(0.5, 1).
\end{aligned}
$$

\clearpage

# The quadratic hazard over log age {#apdx-quadratic-hzrd}

Quadratic relationships between log age and log mortality can be captured by the expression

$$
h(x) = e^{\beta_0 + \beta_1\log(x+1)+\beta_2\log^2(x+1)},
$$

with derivative wrt. $x$

$$
h'(x) = (x+1)^{\beta_1-1}e^{\beta_0+\beta_2\log^2(x+1)}\left(\beta_1+2\beta_2\log(x+1)\right),
$$

and survival function

$$
S(x) 
       = \exp\left(\frac {
         \sqrt{\pi}\exp\left(b_{0}-\frac{(b_{1}+1)^2}{4b_{2}}\right)
         \left(\text{erfi}\left(\frac{b_{1}+1}{2\sqrt{b_{2}}}\right) -
         \text{erfi}\left(\frac{b_{1}+2b_{2}\log(x+1)+1}{2\sqrt{b_{2}}}\right)
         \right)
       } {
         2\sqrt{b_{2}}
       }\right).
$$


An efficient algorithm for the evaluation of the imaginary error function $\text{erfi}(x)=\frac{2}{\sqrt{\pi}}\int_0^{x} \text{exp}\left(t^2\right)\,\text{d}t$ exists [@Poppe1990] and is implemented in the `C++` library `Faddeeva` which can be called from within `R` via the package `RcppFaddeeva`.

\clearpage

# The Vaupel-Zhang equality {#apdx-vz}

I find it instructive to derive the Vaupel-Zhang equality from a simple finite mixture distribution of survival times as it gives justification to the weighted averages employed in this paper. Once the marginal hazard rate has been shown to be a weighted average of hazards among the survivors the proof is the same as @Vaupel2010a.

Let $X$ be the positive real-valued random variable "age at death" and $K$ be a random index denoting membership to the $k$th population stratum. The marginal density of ages at death is given by the discrete mixture distribution

$$
f(x)=\sum_k f(x|k)\mathrm{P}(k),
$$

where $f(x|k)$ is the conditional density of deaths and $\mathrm{P}(k)$ the probability of membership in stratum $k$. By definition the conditional and marginal survival functions are

$$
\begin{aligned}
S(x|k) &= \mathrm{P}(X>x|k) = \int_x^\infty f(x|k)\,\text{d}x \\
S(x) &= \mathrm{P}(X>x) = \int_x^\infty f(x)\,\text{d}x,
\end{aligned}
$$

which give rise to the conditional and marginal hazards via the relationships

$$
\begin{aligned}
h(x|k) &= -S'(x|k)/S(x|k)\\
h(x) &= -S'(x)/S(x),
\end{aligned}
$$

where the prime mark denotes the derivative with respect to age $x$.

The Vaupel-Zhang equality states that for the survivors at age $x$ the age-derivative of their average hazard is equal to the average age derivative minus the variance of the hazards, in their notation

$$
\dot{\overline{h}}(x) = \overline{\dot{h}}(x) - \sigma_h^2(x),
$$

where

$$
\begin{aligned}
  \dot{\overline{h}}(x) &= \left[\sum_k h(x|k)\mathrm{P}(k|X>x)\right]' \\
  \overline{\dot{h}}(x) &= \sum_k h'(x|k)\mathrm{P}(k|X>x) \\
  \sigma_h^2(x) &=
    \sum_k h(x|k)^2 \mathrm{P}(k|X>x) -
    \left[\sum_k h(x|k)\mathrm{P}(k|X>x)\right]^2.
\end{aligned}
$$

**Proof:**

Bayes Theorem gives the probability of being in stratum $k$ given survival to age $x$ as

$$
\mathrm{P}(k|X>x) = \frac{\mathrm{P}(X>x|k)\mathrm{P}(k)} {\mathrm{P}(X>x)} = \frac{S(x|k)\mathrm{P}(k)}{S(x)}
$$

The marginal survival $S(x)$ can be calculated from conditional survival $S(x|k)$ and stratum distribution $\mathrm{P}(k)$ via the law of total probability as

$$
\begin{aligned}
S(x) &= \mathrm{P}(X>x) \\
&= \sum_k \mathrm{P}(X>x|k)\mathrm{P}(k) \\
&= \sum_kS(x|k)\mathrm{P}(k),
\end{aligned}
$$

with age derivative

$$
\begin{aligned}
  S'(x) &= \sum_k S'(x|k)\mathrm{P}(k) \\
        &= \sum_k -h(x|k)S(x|k)\mathrm{P}(k).
\end{aligned}
$$

By substituting $S'(x)$ into $h(x)=-\frac{S'(x)}{S(x)}$ one can express the marginal hazard as a weighted average of the hazards of the survivors:

$$
\begin{aligned}
  h(x) &= -\frac{\sum_k -h(x|k)S(x|k)\mathrm{P}(k)} {S(x)} \\
       &= \sum_k \frac{h(x|k)S(x|k)\mathrm{P}(k)} {S(x)} \\
       &= \sum_k h(x|k)\mathrm{P}(k|X>x).
\end{aligned}
$$

Taking the derivative of $h(x)$ gives

$$
\begin{aligned}
\dot{\overline{h}}(x) &=
\sum_k h'(x|k)\mathrm{P}(k|X>x) + \sum_k h(x|k)\mathrm{P}'(k|X>x) \\
    &= \overline{\dot{h}}(x) +
    \sum_k h(x|k)\mathrm{P}'(k|X>x).
\end{aligned}
$$

The second term can be manipulated to yield

$$
\begin{aligned}
  \sum_k h(x|k)\mathrm{P}'(k|X>x) &=
  \sum_k h(x|k) \left[
      \frac {\mathrm{P}(k)S'(x|k)} {S(x)} -
      \frac {\mathrm{P}(k)S'(x)S(x|k)} {S(x)^2}
    \right]' \\
  &=
  \sum_k \frac {h(x|k)\mathrm{P}(k)S'(x|k)} {S(x)} -
  \sum_k \frac {h(x|k)\mathrm{P}(k)S'(x)S(x|k)} {S(x)^2}  \\
  &=
  \sum_k \frac {h(x|k) \mathrm{P}(k)S'(x|k)} {S(x)} -
  \frac {S'(x)} {S(x)} \sum_k h(x|k) \mathrm{P}(k|X>x) \\
  &=
  \sum_k \frac {h(x|k) \mathrm{P}(k)S'(x|k)} {S(x)} - h(x)^2 \\
  &=
  \sum_k \frac {-h(x|k)^2 \mathrm{P}(k)S(x|k)} {S(x)} - h(x)^2 \\
  &=
  -\sum_k h(x|k)^2 \mathrm{P}(k|X>x) - h(x)^2 \\
  &= 
  -\sigma^2_h(x),
\end{aligned}
$$

completing the proof.

# References
